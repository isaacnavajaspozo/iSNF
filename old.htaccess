<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # Denegar el acceso directo a la carpeta 
    RewriteCond %{REQUEST_URI} ^/iSNF/
    RewriteRule .* - [F,L]
    
    # Restringir el acceso al archivo deployer
    <Files "cli_snake.php">
        Order Deny,Allow
        Deny from all
    </Files>
    
    # Evitar listado de directorios
    Options -Indexes

    # Bloquear el acceso a archivos de configuraci√≥n sensibles
    <FilesMatch "^\.ht">
        Deny from all
    </FilesMatch>
    
    # Establecer encabezados de seguridad
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    
    # Evitar hotlinking de archivos multimedia
    RewriteCond %{HTTP_REFERER} !^$
    RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?dominio.com [NC]
    RewriteRule \.(jpg|jpeg|gif)$ - [NC,F,L]
    
    # Reglas de reescritura
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>


#<IfModule mod_rewrite.c>
#    RewriteEngine On
#    RewriteBase /
#    RewriteCond %{REQUEST_FILENAME} !-f
#    RewriteCond %{REQUEST_FILENAME} !-d
#    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
#</IfModule>

